<!DOCTYPE html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <script src="https://cdn.socket.io/4.3.2/socket.io.min.js"
        integrity="sha384-KAZ4DtjNhLChOB/hxXuKqhMLYvx3b5MlT55xPEiNmREKRzeEm+RVPlTnAn0ajQNs"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lz-string/1.5.0/lz-string.min.js"
        integrity="sha512-qtX0GLM3qX8rxJN1gyDfcnMFFrKvixfoEOwbBib9VafR5vbChV5LeE5wSI/x+IlCkTY5ZFddFDCCfaVJJNnuKQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>

<body>
    RoomID : <input type="text" id="roomID" value="1234" />
    </br>
    <button id="join">Join</button>
    </br>
    <button id="leave" disabled>Leave</button>

    <video id="play" src=""></video>
    </br>
    <audio id="audioPlayer"></audio>
    <div id="log"></div>

    <script type="text/javascript">
        let connected = false;
        let room = {
            id: null,
        }
        const socket = io('ws://localhost:3000');

        socket.emit('live.viewer.connect', { streamer: 'admin' }, (data) => {
        })
        socket.on('live.viewer.connect', (data) => {
        })

        socket.on('connect', () => {
        });
        socket.on('disconnect', (reason) => {
        });
        socket.on('connect_error', (error) => {
        });

        socket.on('live.stream', ({ stream }) => {
            const blob = new Blob([stream], { type: "video/webm" });  // Convert ArrayBuffer to Blob
            const url = URL.createObjectURL(blob);  // Convert Blob to Object URL

            const videoRef = document.getElementById('play');

            videoRef.src = url;  // Set Object URL as the `src` of the video element
        });

    </script>
</body>

</html>